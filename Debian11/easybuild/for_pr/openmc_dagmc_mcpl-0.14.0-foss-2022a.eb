name = 'openmc_dagmc'
version = '0.14.0'

homepage = 'https://openmc.org/'
description = "OpenMC is a community-developed Monte Carlo neutron and photon transport simulation code."
docurls = ['https://docs.openmc.org/en/develop/']
software_license = 'LicenseGCC'
software_license_urls = ['https://docs.openmc.org/en/latest/license.html']
toolchain = {'name': 'foss', 'version': '2022a'}

sources = [{
    'filename': f'openmc-{version}.tar.gz',
    'git_config': {
        'url': 'https://github.com/openmc-dev',
        'repo_name': 'openmc',
        'tag': f'v{version}'
        'recursive':True
    },
}]

# patch to bring 0.14.0 up to commit where uwuw becomes optional
patches = ['openmc-0.14.0_uwuw-optional.patch']

builddependencies = [('CMake', '3.23.1'),('make','4.3')]

dependencies = [
    ('Python', '3.10.4'),
    ('HDF5', '1.12.2'),
    ('dagmc', '3.2.2'),
    ('mcpl', '1.6.2'),
    ('SciPy-bundle','2022.05'),
    ('h5py','3.7.0'),
    ('matplotlib','3.5.2'),
    ('lxml','4.9.1')
]

easyblock = 'CMakeMake'

configopts = f"-DOPENMC_USE_DAGMC=ON -DOPENMC_USE_OPENMP=ON -DOPENMC_USE_MPI=ON -DHDF5_PREFER_PARALLEL=OFF -DOPENMC_USE_MCPL=ON"
postinstallcmds = ['pip install ../openmc/']
